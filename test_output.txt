Reflection warning, /private/var/folders/1t/81x6sszx3tl2q7kz2g1681c80000gn/T/form-init9289045157831331655.clj:1:991 - call to static method invokeStaticMethod on clojure.lang.Reflector can't be resolved (argument types: unknown, java.lang.String, unknown).
Reflection warning, clojure/tools/reader.clj:1025:74 - call to method setLength can't be resolved (target class is unknown).
Reflection warning, clojure/tools/reader.clj:1030:74 - call to method setLength can't be resolved (target class is unknown).
Execution error (SQLException) at com.impossibl.postgres.jdbc.PGDirectConnection/parseSQL (PGDirectConnection.java:448).
Error parsing SQL at position 0 ('CREATE SCHEMA IF NOT EXISTS "scratch";\nCREATE EXTENSION IF NOT EXISTS "citext";\nCREATE EXTENSION IF NOT EXISTS "uuid-ossp";\n\n-- rt.postgres.script.scratch/as-array [16] \nCREATE OR REPLACE FUNCTION "scratch".as_array(\n  input JSONB\n) RETURNS JSONB AS $$\nBEGIN\n  IF input = ''{}'' THEN\n    RETURN ''[]'';\n  END IF;\n  RETURN input;\nEND;\n$$ LANGUAGE ''plpgsql'';\n\n-- rt.postgres.script.scratch/EnumStatus [24] \nDO $$\nBEGIN\n  CREATE TYPE "scratch"."EnumStatus" AS ENUM (''pending'',''error'',''success'');\nEXCEPTION WHEN OTHERS THEN\nEND;\n$$ LANGUAGE ''plpgsql'';\n\n-- rt.postgres.script.scratch/TaskCache [50] \nDROP TABLE IF EXISTS "scratch"."TaskCache" CASCADE;\nCREATE TABLE IF NOT EXISTS "scratch"."TaskCache" (\n  "id" UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  "op_created" UUID,\n  "op_updated" UUID,\n  "time_created" BIGINT,\n  "time_updated" BIGINT,\n  "__deleted__" BOOLEAN DEFAULT false\n);\n\n-- rt.postgres.script.scratch/Task [60] \nDROP TABLE IF EXISTS "scratch"."Task" CASCADE;\nCREATE TABLE IF NOT EXISTS "scratch"."Task" (\n  "id" UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  "status" "scratch"."EnumStatus" NOT NULL,\n  "name" TEXT NOT NULL,\n  "cache_id" UUID NOT NULL REFERENCES "scratch"."TaskCache"("id"),\n  "op_created" UUID,\n  "op_updated" UUID,\n  "time_created" BIGINT,\n  "time_updated" BIGINT,\n  "__deleted__" BOOLEAN DEFAULT false,\n  UNIQUE ("name")\n);\nCREATE INDEX ON "scratch"."Task" USING HASH ("name");\n\n-- rt.postgres.script.scratch/Entry [76] \nDROP TABLE IF EXISTS "scratch"."Entry" CASCADE;\nCREATE TABLE IF NOT EXISTS "scratch"."Entry" (\n  "id" UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  "name" TEXT NOT NULL,\n  "tags" JSONB NOT NULL,\n  "op_created" UUID,\n  "op_updated" UUID,\n  "time_created" BIGINT,\n  "time_updated" BIGINT,\n  "__deleted__" BOOLEAN DEFAULT false,\n  UNIQUE ("name")\n);\nCREATE INDEX ON "scratch"."Entry" USING HASH ("name");\n\n-- rt.postgres.script.scratch/entry-all [89] \nCREATE OR REPLACE FUNCTION "scratch".entry_all() RETURNS JSONB AS $$\n\n  WITH o AS (SELECT "id" FROM "scratch"."Entry") (SELECT jsonb_agg(o.id) FROM o);\n\n$$ LANGUAGE ''sql'';\n\n-- rt.postgres.script.scratch/entry-by-name [94] \nCREATE OR REPLACE FUNCTION "scratch".entry_by_name(\n  i_name TEXT\n) RETURNS JSONB AS $$\n\n  WITH o AS (  \n    SELECT "id" FROM "scratch"."Entry"\n    WHERE "name" = i_name) (SELECT jsonb_agg(o.id) FROM o);\n\n$$ LANGUAGE ''sql'';\n\n-- rt.postgres.script.scratch/entry-default [100] \nCREATE OR REPLACE FUNCTION "scratch".entry_default(\n  i_entry_id UUID\n) RETURNS JSONB AS $$\n\n  WITH j_ret AS (  \n    SELECT "id","name","tags","time_created","time_updated" FROM "scratch"."Entry"\n    WHERE "id" = i_entry_id\n    LIMIT 1)\n  SELECT to_jsonb(j_ret) FROM j_ret;\n\n$$ LANGUAGE ''sql'';\n\n-- rt.postgres.script.scratch/as-upper [107] \nCREATE OR REPLACE FUNCTION "scratch".as_upper(\n  input CITEXT\n) RETURNS CITEXT AS $$\n\n  SELECT (upper((input)::TEXT))::CITEXT;\n\n$$ LANGUAGE ''sql'' IMMUTABLE PARALLEL SAFE;\n\n-- rt.postgres.script.scratch/ping [116] \nCREATE OR REPLACE FUNCTION "scratch".ping() RETURNS TEXT AS $$\nBEGIN\n  RETURN ''pong'';\nEND;\n$$ LANGUAGE ''plpgsql'';\n\n-- rt.postgres.script.scratch/ping-ok [123] \nCREATE OR REPLACE FUNCTION "scratch".ping_ok() RETURNS JSONB AS $$\nBEGIN\n  RETURN jsonb_build_object(''reply'',''ok'');\nEND;\n$$ LANGUAGE ''plpgsql'';\n\n-- rt.postgres.script.scratch/echo [130] \nCREATE OR REPLACE FUNCTION "scratch".echo(\n  input JSONB\n) RETURNS JSONB AS $$\nBEGIN\n  RETURN input;\nEND;\n$$ LANGUAGE ''plpgsql'';\n\n-- rt.postgres.script.scratch/addf [137] \nCREATE OR REPLACE FUNCTION "scratch".addf(\n  x NUMERIC,\n  y NUMERIC\n) RETURNS NUMERIC AS $$\nBEGIN\n  RETURN x + y;\nEND;\n$$ LANGUAGE ''plpgsql'';\n\n-- rt.postgres.script.scratch/subf [144] \nCREATE OR REPLACE FUNCTION "scratch".subf(\n  x NUMERIC,\n  y NUMERIC\n) RETURNS NUMERIC AS $$\nBEGIN\n  RETURN x - y;\nEND;\n$$ LANGUAGE ''plpgsql'';\n\n-- rt.postgres.script.scratch/mulf [151] \nCREATE OR REPLACE FUNCTION "scratch".mulf(\n  x NUMERIC,\n  y NUMERIC\n) RETURNS NUMERIC AS $$\nBEGIN\n  RETURN x * y;\nEND;\n$$ LANGUAGE ''plpgsql'';\n\n-- rt.postgres.script.scratch/divf [158] \nCREATE OR REPLACE FUNCTION "scratch".divf(\n  x NUMERIC,\n  y NUMERIC\n) RETURNS NUMERIC AS $$\nBEGIN\n  RETURN x / y;\nEND;\n$$ LANGUAGE ''plpgsql'';\n\n-- rt.postgres.script.scratch/insert-task [165] \nCREATE OR REPLACE FUNCTION "scratch".insert_task(\n  i_name TEXT,\n  i_status TEXT,\n  o_op JSONB\n) RETURNS JSONB AS $$\n\n  DECLARE\n    out JSONB;\n  BEGIN\n    DECLARE\n      p_id_00 UUID;\n      p_id_01 UUID;\n      gid_1 JSONB;\n      gid_2 JSONB;\n    BEGIN\n      p_id_01 := uuid_generate_v4();\n      p_id_00 := uuid_generate_v4();\n      WITH j_ret AS (  \n        INSERT INTO "scratch"."TaskCache" ("id","op_created","op_updated","time_created","time_updated") VALUES (\n          (p_id_01)::UUID,\n          (o_op ->> ''id'')::UUID,\n          (o_op ->> ''id'')::UUID,\n          (o_op ->> ''time'')::BIGINT,\n          (o_op ->> ''time'')::BIGINT\n        ) RETURNING *)\n      SELECT to_jsonb(j_ret) FROM j_ret INTO gid_2;\n      WITH j_ret AS (  \n        INSERT INTO "scratch"."Task" (\n          "id",\n          "status",\n          "name",\n          "cache_id",\n          "op_created",\n          "op_updated",\n          "time_created",\n          "time_updated"\n        ) VALUES (\n          (p_id_00)::UUID,\n          (i_status)::"scratch"."EnumStatus",\n          (i_name)::TEXT,\n          (p_id_01)::UUID,\n          (o_op ->> ''id'')::UUID,\n          (o_op ->> ''id'')::UUID,\n          (o_op ->> ''time'')::BIGINT,\n          (o_op ->> ''time'')::BIGINT\n        ) RETURNING *)\n      SELECT to_jsonb(j_ret) FROM j_ret INTO gid_1;\n      gid_1 := (gid_1 || jsonb_build_object(''cache'',gid_2));\n      SELECT gid_1 INTO out;\n    END;\n    RETURN out;\n  END;\n\n$$ LANGUAGE ''plpgsql'';\n\n-- rt.postgres.script.scratch/insert-entry [176] \nCREATE OR REPLACE FUNCTION "scratch".insert_entry(\n  i_name TEXT,\n  i_tags JSONB,\n  o_op JSONB\n) RETURNS JSONB AS $$\n\n  DECLARE\n    out JSONB;\n  BEGIN\n    DECLARE\n      p_id_00 UUID;\n      gid_1 JSONB;\n    BEGIN\n      p_id_00 := uuid_generate_v4();\n      WITH j_ret AS (  \n        INSERT INTO "scratch"."Entry" (\n          "id",\n          "name",\n          "tags",\n          "op_created",\n          "op_updated",\n          "time_created",\n          "time_updated"\n        ) VALUES (\n          (p_id_00)::UUID,\n          (i_name)::TEXT,\n          "scratch".as_array((i_tags)::JSONB),\n          (o_op ->> ''id'')::UUID,\n          (o_op ->> ''id'')::UUID,\n          (o_op ->> ''time'')::BIGINT,\n          (o_op ->> ''time'')::BIGINT\n        ) RETURNING *)\n      SELECT to_jsonb(j_ret) FROM j_ret INTO gid_1;\n      SELECT gid_1 INTO out;\n    END;\n    RETURN out;\n  END;\n\n$$ LANGUAGE ''plpgsql'';'): Error near: 'CREATE SC

Full report at:
/var/folders/1t/81x6sszx3tl2q7kz2g1681c80000gn/T/clojure-13673283613915696149.edn
